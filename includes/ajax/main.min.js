$(document).ready(function() {
    let socket = io();

    let checker;

    $(document).on('click', 'a.dmd_navbar_home_btn', function(e) {
        e.preventDefault();

        // let open = $(this).data("open");
        let scrollto = $(this).data("scrollto");

        if (checker === "" || checker === undefined || checker === null) {} else {
            // window.location.replace("#"+scrollto+"");
            window.history.pushState('', '', '/#'+scrollto);
            location.reload();
        }
    });


    $(document).on('click', 'a.dmd_navbar_btn', function(e) {
        e.preventDefault();

        let open = $(this).data("open");
        let scrollto = $(this).data("scrollto");
        let thisElement = $(this);

        if (open == "home") {
            if (checker === "" || checker === undefined || checker === null) {} else {
                // if (open !== "contact") {
                    window.history.pushState('', '', '/#'+scrollto);
                    location.reload();
                // }
                
            }
        } else {
            thisElement.append('<div class="spinner-border text-light"></div>');
            socket.emit('navigation', {
                filename: open
            });
        }
    });


    //Get navigation response
    socket.on('_navigation', function(data) {
        if (data.type == "error") {
            console.log(data.message);
        } else {
            $(".dmd_main_page_display").html(data.fileData);
            checker = data.filename;
            $('.dmd_nav_active_switch').removeClass("active");
            $('.dmd_nav_switch_'+data.filename).addClass("active");
            $('html, body').animate({ scrollTop: 0 }, "slow");
        }
        $('div.spinner-border').remove();
        $('.book_a_doctor_sticky').remove();
    });


    //Register / Login Page Navigations
    $(document).on('click', 'a.dmd_auth_switch_btn', function(e) {
        e.preventDefault();
        let open = $(this).data("open");
        $('.dmd_auth_both_forms').hide();
        $('.'+open).show();
        if (open == "dmd_auth_register_form") {
            $('.dmd_auth_page_titles').html(`
                <h3 class="mt-5">Client Registration Form</h3>
                <p>
                    Fill out this form to become our registered client <br>
                    Already a client? 
                    <a href="#" class="dmd_auth_switch_btn" data-open="dmd_auth_login_form">Log In Here</a>
                </p>
            `);
        } else {
            $('.dmd_auth_page_titles').html(`
                <h3 class="mt-5">Log Into Account</h3>
                <p>
                    Access your account by filling out this form <br>
                    Don't have an account? 
                    <a href="#" class="dmd_auth_switch_btn" data-open="dmd_auth_register_form">Register Here</a>
                </p>
            `);
        }
    });
});